test_name: Users API Test - User Creation

includes:
  - !include includes.yaml

stages:
  - name: Create a user
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user"
      method: POST
      json:
        username: jeffylo941
        password: ABCDE12345
        displayname: Jelly Jello
        email: jelly@csu.fullerton.edu
      headers:
        content-type: application/json
    response:
      status_code: 201

---

test_name: Users API Test - User Retrieval

includes:
  - !include includes.yaml

stages:
  - name: Create a user
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user"
      method: POST
      json:
        username: jeffylo942
        password: ABCDE12345
        displayname: Jelly Jello
        email: jelly@csu.fullerton.edu
      headers:
        content-type: application/json
    response:
      status_code: 201

  - name: get a user
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user?username=jeffylo94"
      method: GET
      headers:
        content-type: application/json
    response:
      status_code: 200
      body: !anything

---

test_name: Users API Test - User Deletion

includes:
  - !include includes.yaml

stages:
  - name: Create a user
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user"
      method: POST
      json:
        username: jeffylo943
        password: ABCDE12345
        displayname: Jelly Jello
        email: jelly@csu.fullerton.edu
      headers:
        content-type: application/json
    response:
      status_code: 201

  - name: delete a user
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user/1"
      method: DELETE
      headers:
        content-type: application/json
    response:
      status_code: 200

---

test_name: Users API Test - Password change

includes:
  - !include includes.yaml

stages:
  - name: change password
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user/chpass/"
      method: PUT
      json:
        id: 2
        username: jeffylo944
        password: 987654321
        displayname: Jelly Jello
        email: jelly@csu.fullerton.edu
      headers:
        content-type: application/json
    response:
      status_code: 200

---

test_name: Users API Test - User Authentication

includes:
  - !include includes.yaml

stages:
  - name: Valid User
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user/auth"
      method: POST
      json:
        username: jeffylo945
        password: 987654321
      headers:
        content-type: application/json
    response:
      status_code: 200

  - name: INVALID User
    request:
      url: "{protocol:s}://{host:s}:{users_port:d}/user/auth"
      method: POST
      json:
        username: jeffylo946
        password: notAPassword
      headers:
        content-type: application/json
    response:
      status_code: 403
